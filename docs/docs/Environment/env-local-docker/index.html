<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Docker in Local OS ::: tip For the purpose of the environment normalization, we provide a simple docker image for you, which contains most of the software required by this course. We also provide a few scripts to install some optional packages. :::
The whole progress would seem as follow:
 Make sure you have enough resource:  It requires at least 8GB Physical RAM, 16GB or greater would be better It requires at least 15GB hard disk storage   Install a docker environment in local machine Start Docker Service, pull images and create a instance Just rock it!"><meta property="og:title" content="" />
<meta property="og:description" content="Docker in Local OS ::: tip For the purpose of the environment normalization, we provide a simple docker image for you, which contains most of the software required by this course. We also provide a few scripts to install some optional packages. :::
The whole progress would seem as follow:
 Make sure you have enough resource:  It requires at least 8GB Physical RAM, 16GB or greater would be better It requires at least 15GB hard disk storage   Install a docker environment in local machine Start Docker Service, pull images and create a instance Just rock it!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://franticnerd.github.io/bigdata-bootcamp/docs/environment/env-local-docker/" />

<title>Env Local Docker | GT Big Data Bootcamp</title>
<link rel="icon" href="/bigdata-bootcamp/favicon.png" type="image/x-icon">


<link rel="stylesheet" href="/bigdata-bootcamp/book.min.63eb88daa545365405ecdbb21033286a325c60a36cfa6d22d21e7c3bc9286941.css" integrity="sha256-Y&#43;uI2qVFNlQF7NuyEDMoajJcYKNs&#43;m0i0h58O8koaUE=">


<script defer src="/bigdata-bootcamp/en.search.min.893faf5011e462c05924d1cdb6f65ce2425a1693f23cd9a0bf9a1c9e26c79afd.js" integrity="sha256-iT&#43;vUBHkYsBZJNHNtvZc4kJaFpPyPNmgv5ocnibHmv0="></script>

<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body>
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="container flex">
    <aside class="book-menu">
      
  <nav>
<h2 class="book-brand">
  <a href="/bigdata-bootcamp"><span>GT Big Data Bootcamp</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>











  

  
  





 
  
    




  
  <ul>
    
      
        

  <li class="book-section-flat" >
    

  
  <span>Environment</span>
  


    




  
  <ul>
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/environment/env-aws-docker/" class="">Env Aws Docker</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/environment/env-azure-docker/" class="">Env Azure Docker</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/environment/env-docker-compose/" class="">Env Docker Compose</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/environment/env-local-docker-linux/" class="">Env Local Docker Linux</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/environment/env-local-docker-macos/" class="">Env Local Docker Macos</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/environment/env-local-docker-windows/" class="">Env Local Docker Windows</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/environment/env-local-docker/" class="active">Env Local Docker</a>
  

</li>
      
    
  </ul>
  



  </li>


      
    
      
        

  <li class="book-section-flat" >
    

  
  <span>Sessions</span>
  


    




  
  <ul>
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/scala-basic/" class="">Scala Basic</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/scala-intro/" class="">Scala Intro</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/spark-application/" class="">Spark Application</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/spark-basic/" class="">Spark Basic</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/spark-graphx/" class="">Spark Graphx</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/spark-mllib/" class="">Spark Mllib</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/spark-sql/" class="">Spark Sql</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/spark/" class="">Spark</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/zeppelin-intro/" class="">Zeppelin Intro</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/zeppelin-tutorial/" class="">Zeppelin Tutorial</a>
  

</li>
      
    
  </ul>
  



  </li>


      
    
  </ul>
  



  
















</nav>




  <script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script>


 
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/bigdata-bootcamp/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Env Local Docker</strong>

  <label for="toc-control">
    <img src="/bigdata-bootcamp/svg/toc.svg" class="book-icon" alt="Table of Contents" />
  </label>
</div>


  
    <input type="checkbox" class="hidden" id="toc-control" />
    <aside class="hidden clearfix">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#0-system-environment">0. System Environment</a></li>
    <li><a href="#1-install-docker">1. Install Docker</a></li>
    <li><a href="#2-pull-and-run-docker-image">2. Pull and run Docker image</a>
      <ul>
        <li><a href="#1-start-the-container-with">(1) Start the container with:</a></li>
        <li><a href="#2-start-all-necessary-services">(2) Start all necessary services</a></li>
        <li><a href="#3-stop-all-services">(3) Stop all services</a></li>
        <li><a href="#4-detach-or-exit">(4) Detach or Exit</a></li>
        <li><a href="#5-re-attach">(5) Re-attach</a></li>
        <li><a href="#5-destroy-instance">(5) Destroy instance</a></li>
        <li><a href="#6-destroy-images">(6) Destroy images</a></li>
        <li><a href="#7-update-images">(7) Update images</a></li>
        <li><a href="#8-more-official-documents">(8) More official documents</a></li>
        <li><a href="#9-optional-use-docker-compose">(9) Optional: use docker-compose</a></li>
      </ul>
    </li>
    <li><a href="#3-logs-and-diagnosis">3. Logs and Diagnosis</a>
      <ul>
        <li><a href="#system-configurations">System Configurations</a></li>
        <li><a href="#logs">Logs</a></li>
        <li><a href="#misc">Misc.</a></li>
      </ul>
    </li>
  </ul>
</nav>


    </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="docker-in-local-os">Docker in Local OS</h1>
<p>::: tip
For the purpose of the environment normalization, we provide a simple <a href="https://docs.docker.com/">docker</a> image for you, which contains most of the software required by this course. We also provide a few scripts to install some optional packages.
:::</p>
<p>The whole progress would seem as follow:</p>
<ol>
<li><strong>Make sure you have enough resource</strong>:
<ol>
<li>It requires at least 8GB Physical RAM, 16GB or greater would be better</li>
<li>It requires at least 15GB hard disk storage</li>
</ol>
</li>
<li>Install a docker environment in local machine</li>
<li>Start Docker Service, pull images and create a instance</li>
<li>Just rock it!</li>
<li>Destroy the containers and images if they are not required anymore</li>
</ol>
<p>::: warning
Since this docker image integrated a lot of related services for the course, it requires at least 4GB RAM for this virtual machine. If your can not meet the minimum requirement, the system could randomly kill one or a few process due to resource limitation, which causes a lot of strange errors which is even unable to reproduce.</p>
<p><strong>DON&rsquo;T TRY TO DO THAT.</strong></p>
<p>You may try <a href="/env/env-azure-docker.html">Azure</a> instead.
:::</p>
<p>[[toc]]</p>
<h2 id="0-system-environment">0. System Environment</h2>
<p>You should have enough system resource if you are planning to start a container in your local OS.</p>
<p>You are supposed to reserve at least 4 GB RAM for Docker, and some other memory for the host machine. While, you can still start all the Hadoop related services except <a href="https://zeppelin.apache.org">Zeppelin</a>, even if you only reserve 4GB for the virtual machine.</p>
<h2 id="1-install-docker">1. Install Docker</h2>
<p>Docker is a software technology providing operating-system-level virtualization also known as containers, promoted by the company <a href="docker.com">Docker, Inc.</a>. Docker uses the resource isolation features of the Linux kernel such as cgroups and kernel namespaces, and a union-capable file system such as OverlayFS and others to allow independent &ldquo;containers&rdquo; to run within a single Linux instance, avoiding the overhead of starting and maintaining virtual machines (VMs). (from <a href="https://en.wikipedia.org/wiki/Docker_%28software%29">Wikipedia</a>)</p>
<p>Basically, you can treat docker as a lightweight virtual machine hosted on Linux with a pretty high performance.</p>
<p>The principle of setting up a docker environment is pretty straightforward.</p>
<ul>
<li>IF your operating system is Linux, you are supposed to install docker service directly</li>
<li>IF your operating system is mac OS, Windows,  FreeBSD, and so on, you are supposed to install a virtual machine, start a special configured Linux system which hosts a Docker service. You will control the dockers using remote tool</li>
</ul>
<p>There is an official instruction from <a href="https://docs.docker.com/engine/installation/">the link</a>. You can check the official documentation to get the latest news and some detail explanations.</p>
<ul>
<li><a href="/env/env-local-docker-linux.html">Install Docker In Linux</a></li>
<li><a href="/env/env-local-docker-macos.html">Install Docker In macOS</a></li>
<li><a href="/env/env-local-docker-windows.html">Install Docker In Microsoft Windows</a></li>
</ul>
<p>Once the docker installed, you should get a few commands start from docker and able to start your docker service, and launch your docker container.</p>
<ul>
<li>docker - a tool to control docker</li>
<li>docker-machine -  a tool that lets you install Docker Engine on virtual hosts, and manage the hosts in remote</li>
<li>docker-compose - a tool for defining and running multi-container Docker applications</li>
</ul>
<p>If we are using VirtualBox + Windows/macOS, the theory is pretty clear: we created a Linux instance in &ldquo;virtual remote&rdquo;, and control it using docker-machine. If we are supposed to operate the &ldquo;remote docker service&rdquo;, we are supposed to prepare a set of environment variables. We can list it using command:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">docker-machine env default
</code></pre></div><p>This is the reason that why do we have to execute the follow command to access the docker.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">eval <span style="color:#66d9ef">$(</span>docker-machine env default<span style="color:#66d9ef">)</span>
</code></pre></div><p>::: tip</p>
<p>If you are using docker-machine, you can not reach the port from virtual machine using ip 127.0.0.1 (localhost). As replacement, you should extract the IP using this command:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ printenv  | grep <span style="color:#e6db74">&#34;DOCKER_HOST&#34;</span>
DOCKER_HOST<span style="color:#f92672">=</span>tcp://192.168.99.100:2376
</code></pre></div><p>And then you should visit <code>192.168.99.100</code> instead of <code>127.0.0.1</code> to visit the network stream from virtual machine.</p>
<p>:::</p>
<p>If these environment are unsetted, docker will try to connect to the default unix socket file <code>/var/run/docker.sock</code>.</p>
<p>As a Docker.app user, this file is:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ls -alh /var/run/docker.sock
lrwxr-xr-x  <span style="color:#ae81ff">1</span> root  daemon    55B Feb <span style="color:#ae81ff">10</span> 19:09 /var/run/docker.sock -&gt; /Users/yu/Library/Containers/com.docker.docker/Data/s60
$ ls -al /Users/yu/Library/Containers/com.docker.docker/Data/s60
srwxr-xr-x  <span style="color:#ae81ff">1</span> yu  staff  <span style="color:#ae81ff">0</span> Feb <span style="color:#ae81ff">10</span> 19:09 /Users/yu/Library/Containers/com.docker.docker/Data/s60
</code></pre></div><p>As a Linux user, the situation is slightly different:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ls -al /var/run/docker.sock
srw-rw---- <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">0</span> Feb <span style="color:#ae81ff">11</span> 11:35 /var/run/docker.sock
</code></pre></div><p>::: tip
A Linux user <strong>must</strong> add a &ldquo;sudo&rdquo; before command <code>docker</code> since he has no access to <code>docker.sock</code> as an ordinary user.
:::</p>
<h2 id="2-pull-and-run-docker-image">2. Pull and run Docker image</h2>
<h3 id="1-start-the-container-with">(1) Start the container with:</h3>
<p>The basic start command should be:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">docker run -it --privileged<span style="color:#f92672">=</span>true <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  --cap-add<span style="color:#f92672">=</span>SYS_ADMIN <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  -m 8192m -h bootcamp.local <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  --name bigbox -p 2222:22 -p 9530:9530 -p 8888:8888<span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  -v /:/mnt/host <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  sunlab/bigbox:latest <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  /bin/bash
</code></pre></div><p>In general, the synopsis of <code>docker run</code> is</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">docker run <span style="color:#f92672">[</span>options<span style="color:#f92672">]</span> image<span style="color:#f92672">[</span>:tag|@digest<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>command<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>args<span style="color:#f92672">]</span>
</code></pre></div><p>Here is a case study to the options:</p>
<blockquote>
<p>-p host-port:vm-port</p>
</blockquote>
<p>This option is used to map the TCP port <code>vm-port</code> in the container to port <code>host-port</code> on the Docker host.</p>
<p>Currently, <code>vm-port</code>s are reserved to:</p>
<ul>
<li>8888 - Jupyter Notebook</li>
<li>9530 - Zeppelin Notebook</li>
</ul>
<p>Once you started the Zeppelin service, this service will keep listening port <code>9530</code> in docker. You should able to visit this service using <code>http://127.0.0.1:9530</code> or <code>http://DOCKER_HOST_IP:9530</code>.</p>
<p>This remote IP depends on the Docker Service you are running, which has already described above.</p>
<ul>
<li>If you are using Linux or Docker.app in macOS, you just need to visit &ldquo;localhost:9530&rdquo;, or other port numbers if you changed <code>host-port</code></li>
<li>If you are using VirtualBox + macOS or Windows, you should get the Docker&rsquo;s IP first</li>
</ul>
<blockquote>
<p>-v, &ndash;volume=[host-src:]container-dest[:&lt;options&gt;]</p>
</blockquote>
<p>This option is used to bind mount a volume.</p>
<p>Currently, we are using <code>-v /:/mnt/host</code>. In this case, we can visit the root of your file system for your host machine. If you are using macOS, <code>/mnt/host/Users/&lt;yourname&gt;/</code> would be the <code>$HOME</code> of your MacBook. If you are using Windows, you can reach your <code>C:</code> disk from <code>/mnt/host/c</code> in docker.</p>
<p>Variable <code>host-src</code> accepts absolute path only.</p>
<blockquote>
<p>-it</p>
</blockquote>
<ul>
<li>-i              : Keep STDIN open even if not attached</li>
<li>-t              : Allocate a pseudo-tty</li>
</ul>
<blockquote>
<p>-h bootcamp.local</p>
</blockquote>
<p>Once you enter this docker environment, you can ping this docker environment itself as <code>bootcamp.local</code>. This variable is used in some configuration files for Hadoop ecosystems.</p>
<blockquote>
<p>-m 8192m</p>
</blockquote>
<p>Memory limit (format: <code>&lt;number&gt;[&lt;unit&gt;]</code>). Number is a positive integer. Unit can be one of <code>b</code>, <code>k</code>, <code>m</code>, or <code>g</code>.</p>
<p>This docker image requires at least 4G RAM, 8G RAM is recommended. However, if your local Physical Machine has ONLY 8G RAM, you are recommended to reduce this number to 4G.</p>
<p>Local machine is not the same as the remote server. If you are launching a remote server with 8G RAM, you can set this number as 7G.</p>
<p>If you are interested in the detail explanation of the args, please visit <a href="https://docs.docker.com/engine/reference/run/">this link</a></p>
<h3 id="2-start-all-necessary-services">(2) Start all necessary services</h3>
<p>In generally, when you are in front of the command line interface, you will meet 2 kinds of prompt.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># whoami  # this prompt is &#39;#&#39;</span> 
	<span style="color:#75715e">#indices you are root aka the administrator of this environment now</span>
root
$ whoami <span style="color:#75715e"># this promot is &#39;$&#39; indices you are a ordinary user now</span>
yu
</code></pre></div><p>Of course, it is pretty easy to change, you can simply update the environment variable <code>PS1</code>.</p>
<p>Assumption: every script is executed by <code>root</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">/scripts/start-services.sh
</code></pre></div><p>This script will help you start a the services for Hadoop ecosystems. You may meet &ldquo;Connection Refused&rdquo; exception if you did something else before started these services.</p>
<p>If you wish to host Zeppelin, you should install it first by using the command:</p>
<pre><code>/scripts/install-zeppelin.sh
</code></pre><p>and start the service by using command:</p>
<pre><code>/scripts/start-zeppelin.sh
</code></pre><p>then, Zeppelin will listen the port <code>9530</code></p>
<p>Note: Please keep all the service are running before installing/starting Zeppelin.</p>
<p>If you wish to host Jupyter, you can start it by using command:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">/scripts/start-jupyter.sh
</code></pre></div><p>Jupyter will listen the port <code>8888</code></p>
<h3 id="3-stop-all-services">(3) Stop all services</h3>
<p>You can stop services if you want:</p>
<pre><code>/scripts/stop-services.sh
</code></pre><h3 id="4-detach-or-exit">(4) Detach or Exit</h3>
<p>To detach instance for keeping it up,</p>
<pre><code>ctrl + p, ctrl + q
</code></pre><p>To exit,</p>
<pre><code>exit
</code></pre><h3 id="5-re-attach">(5) Re-attach</h3>
<p>If you detached a instance and want to attach again,
check the <code>CONTAINER ID</code> or <code>NAMES</code> of it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ docker ps -a
CONTAINER ID        IMAGE                  COMMAND                CREATED             STATUS              PORTS                                                                  NAMES
011547e95ef5        sunlab/bigbox:latest   <span style="color:#e6db74">&#34;/tini -- /bin/bash&#34;</span>   <span style="color:#ae81ff">6</span> hours ago         Up <span style="color:#ae81ff">4</span> seconds        0.0.0.0:8888-&gt;8888/tcp, 0.0.0.0:9530-&gt;9530/tcp, 0.0.0.0:2222-&gt;22/tcp   bigbox
</code></pre></div><p>If the &ldquo;STATUS&rdquo; column is similar to &ldquo;Exited (0) 10 hours ago&rdquo;, you are supposed to start the container again.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ docker start &lt;CONTAINER ID or NAMES&gt;
</code></pre></div><p>Then attach it by:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ docker attach &lt;CONTAINER ID or NAMES&gt;
</code></pre></div><p>Every time you restart your container, you are supposed to start all those services again before any HDFS related operations.</p>
<h3 id="5-destroy-instance">(5) Destroy instance</h3>
<p>If you want to permanently remove container</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ docker rm &lt;CONTAINER ID or NAMES&gt;
</code></pre></div><h3 id="6-destroy-images">(6) Destroy images</h3>
<p>If you want to permanently remove images</p>
<p>List images first</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
sunlab/bigbox       latest              bfd258e00de3        <span style="color:#ae81ff">16</span> hours ago        2.65GB
</code></pre></div><p>Remove them by REPOSITORY or IMAGE ID using command:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ docker rmi &lt;REPOSITORY or IMAGE ID&gt;
</code></pre></div><h3 id="7-update-images">(7) Update images</h3>
<pre><code>$ docker pull sunlab/bigbox
</code></pre><h3 id="8-more-official-documents">(8) More official documents</h3>
<p>Please refer to <a href="https://docs.docker.com/v17.09/engine/userguide/storagedriver/imagesandcontainers/">this link</a> for the introduction of images, containers, and storage drivers.</p>
<h3 id="9-optional-use-docker-compose">(9) Optional: use docker-compose</h3>
<p><a href="https://docs.docker.com/compose/">Docker Compose</a> is a tool for defining and running multi-container Docker applications. A simple <code>docker-compose.yml</code> could <em><strong>simplify</strong></em> the parameters, and make the life easier.</p>
<p>Please refer to <a href="/env/env-docker-compose.html#docker-compose">this link</a> for some further instruction.</p>
<h2 id="3-logs-and-diagnosis">3. Logs and Diagnosis</h2>
<h3 id="system-configurations">System Configurations</h3>
<pre><code>## cat /proc/meminfo  | grep Mem ## Current Memory
MemTotal:        8164680 kB ## Note: This value shoud no less than 4GB
MemFree:          175524 kB
MemAvailable:    5113340 kB
## cat /proc/cpuinfo  | grep 'model name' | head -1  ## CPU Brand
model name	: Intel(R) Core(TM) i7-7920HQ CPU @ 3.10GHz
## cat /proc/cpuinfo  | grep 'model name' | wc -l ## CPU Count
4
## df -h ## List Current Hard Disk Usage
Filesystem      Size  Used Avail Use% Mounted on
overlay          32G  4.6G   26G  16% /
tmpfs            64M     0   64M   0% /dev
...
## ps -ef ## List Current Running Process
UID        PID  PPID  C STIME TTY          TIME CMD
root         1     0  0 01:38 pts/0    00:00:00 /tini -- /bin/bash
root         7     1  0 01:38 pts/0    00:00:00 /bin/bash
root        77     1  0 01:43 ?        00:00:00 /usr/sbin/sshd
zookeep+   136     1  0 01:43 ?        00:00:14 /usr/lib/jvm/java-openjdk/bin/java -Dzookeeper.log.dir=/var/log/zookeeper -Dzookeeper.root.logger=INFO,ROLLINGFILE -cp /usr/lib/zookeeper/bin/../build/classes:/
yarn       225     1  0 01:43 ?        00:00:13 /usr/lib/jvm/java/bin/java -Dproc_proxyserver -Xmx1000m -Dhadoop.log.dir=/var/log/hadoop-yarn -Dyarn.log.dir=/var/log/hadoop-yarn -Dhadoop.log.file=yarn-yarn-pr
...
## lsof -i:9530 ## Find the Process Listening to Some Specific Port
COMMAND  PID     USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
java    3165 zeppelin  189u  IPv4 229945      0t0  TCP *:9530 (LISTEN)
</code></pre><h3 id="logs">Logs</h3>
<ul>
<li><strong>hadoop-hdfs</strong> &ndash; /var/log/hadoop-hdfs/*</li>
<li><strong>hadoop-mapreduce</strong>  &ndash; /var/log/hadoop-mapreduce/*</li>
<li><strong>hadoop-yarn</strong> &ndash; /var/log/hadoop-yarn/*</li>
<li><strong>hbase</strong>  &ndash;  /var/log/hbase/*</li>
<li><strong>hive</strong>  &ndash; /var/log/hive/*</li>
<li><strong>spark</strong>  &ndash; /var/log/spark/*</li>
<li><strong>zookeeper</strong> &ndash; /var/log/zookeeper/*</li>
<li><strong>zeppelin</strong> &ndash; /usr/local/zeppelin/logs/*</li>
</ul>
<h3 id="misc">Misc.</h3>
<h4 id="user-and-role">User and Role</h4>
<pre><code>[root@bootcamp1 /]# su hdfs  ## This command is used to switch your current user to hdfs
					## Note: switch user requires special permission
					## You can not switch back using su root again
bash-4.2$ whoami ## check current user
hdfs
bash-4.2$ exit ## role is a stack, you can quit your role from hdfs to root
[root@bootcamp1 /]#
[root@bootcamp1 /]# sudo -u hdfs whoami ## execute a command 'whoami' using user 'hdfs'
hdfs
[root@bootcamp1 /]#

</code></pre><p>User <code>hdfs</code> is the super user in HDFS system. User <code>root</code> is the super user in Linux system.</p>
<pre><code>[root@bootcamp1 /]# sudo -u hdfs hdfs dfs -mkdir /tmp
</code></pre><p>In this case, user root has no permission to write data in <code>/</code>, but it could ask user hdfs to process it.</p>
<h4 id="relative-path-and-absolute-path">Relative Path and Absolute Path</h4>
<p>An absolute or full path points to the same location in a file system, regardless of the current working directory. To do that, it must include the root directory. <a href="https://en.wikipedia.org/wiki/Path_%28computing%29#Absolute_and_relative_paths">wiki</a>.</p>
<p>When we are talking about <code>/mnt/host</code>, it always pointing to the path <code>/mnt/host</code>. However, if the path is not startswith &ldquo;/&quot;, it means to start from &ldquo;current working path&rdquo;.</p>
<p>In Linux system, you can get your &ldquo;current working path&rdquo; using command</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e">## pwd</span>
/root
</code></pre></div><p>In HDFS system, the &ldquo;current working path&rdquo; would be <code>/user/&lt;your-name&gt;</code>.</p>
<p>A relative path would be the result of <code>cwd</code> plus your string.</p>
<p>When we are coding in hadoop, we may required to fill in a location pointing to the path of input files. The synopsis of this path is is</p>
<p><code>[schema://]your-path</code></p>
<p>An HDFS path <code>hdfs:///hw1/test.csv</code> is combined by <code>hdfs://</code> and  <code>/hw1/test.csv</code>. There are 3 slashes over there. If you only filled 2 slashes over there (<code>hdfs://hw1/test.csv</code>), it is equal to <code>hdfs:///user/root/hw1/test.csv</code>, which may not be expected.</p>
<p>Ditto for <code>file:///path/to/your/local/file.csv</code>.</p>
<h4 id="other-linux-commands">Other Linux Commands</h4>
<p>This environment is based on CentOS 7. This course does not requires you have too much knowledge in Linux, but if you can use some basic commands, that would be better.</p>
<p>If you are interested, please refer to <a href="https://files.fosswire.com/2007/08/fwunixref.pdf">this link</a> for a Unix/Linux Command Cheat Sheet.</p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex justify-between">





</div>

 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#0-system-environment">0. System Environment</a></li>
    <li><a href="#1-install-docker">1. Install Docker</a></li>
    <li><a href="#2-pull-and-run-docker-image">2. Pull and run Docker image</a>
      <ul>
        <li><a href="#1-start-the-container-with">(1) Start the container with:</a></li>
        <li><a href="#2-start-all-necessary-services">(2) Start all necessary services</a></li>
        <li><a href="#3-stop-all-services">(3) Stop all services</a></li>
        <li><a href="#4-detach-or-exit">(4) Detach or Exit</a></li>
        <li><a href="#5-re-attach">(5) Re-attach</a></li>
        <li><a href="#5-destroy-instance">(5) Destroy instance</a></li>
        <li><a href="#6-destroy-images">(6) Destroy images</a></li>
        <li><a href="#7-update-images">(7) Update images</a></li>
        <li><a href="#8-more-official-documents">(8) More official documents</a></li>
        <li><a href="#9-optional-use-docker-compose">(9) Optional: use docker-compose</a></li>
      </ul>
    </li>
    <li><a href="#3-logs-and-diagnosis">3. Logs and Diagnosis</a>
      <ul>
        <li><a href="#system-configurations">System Configurations</a></li>
        <li><a href="#logs">Logs</a></li>
        <li><a href="#misc">Misc.</a></li>
      </ul>
    </li>
  </ul>
</nav>

 
    </aside>
    
  </main>

  
</body>

</html>












